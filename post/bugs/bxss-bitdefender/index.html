<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Inside a global leader in CyberSecurity [bitdefender dashboard] | s1m0x - IT Enthusiast | CyberSec - DevOps - Devs</title>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.2/css/all.css">
    
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <meta property="og:title" content="Inside a global leader in CyberSecurity [bitdefender dashboard]" />
<meta property="og:description" content="How I was able to access one of the russian antivirus (Bitdefender) domains through blind xss !" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://s1m0x.xyz/post/bugs/bxss-bitdefender/" />
<meta property="og:image" content="https://s1m0x.xyz/images/Ynhzcy1iaXRkZWZlbmRlcgo=.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="article:published_time" content="2020-01-26T01:06:41+01:00" />
<meta property="article:modified_time" content="2020-01-26T01:06:41+01:00" />

  </head>

  <body>
    
    <div class="progress-container">
      <div class="progress-bar" id="myBar"></div>
    </div>  
    <nav>
    <ul class="menu">
      
      <li><a href="/about">About</a></li>
      
      <li><a href="/">Posts</a></li>
      
      <li><a href="/categories">Categories</a></li>
      
      <li><a href="/tags">Tags</a></li>
      
    </ul>

    <ul class="menu">
    
      <li><a href="https://fb.me/simo.balghaoui"><i class="fa-brands fa-facebook fa-2xl"></i></a></li>

      <li><a href="https://github.com/s1m0x"><i class="fa-brands fa-github fa-2xl"></i></a></li>

      <li><a href="https://ma.linkedin.com/in/mohamed-bal-ghaoui-b67ab1128"><i class="fa-brands fa-linkedin-in fa-2xl"></i></a></li>

    </ul>
    
    </div>
    <hr/>
    </nav>

<div class="article-meta">
<h1><span class="title">Inside a global leader in CyberSecurity [bitdefender dashboard]</span></h1>

<h2 class="date">Jan. 26, 2020</h2>
</div>

<main>
<figure>
<img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo=.png" width="600px" height="300px"/> </figure>
<h3 id="intro">Intro:</h3>
<p>While ago I have discovered a blind cross-site-scripting that allowed me to access the bitdefender administrator&rsquo;s dashboard a Czech Republic bitdefender&rsquo;s domain., with plenty of functionalities, and this is how it went:</p>
<p>So, the vulnerability is named <code>blind</code> for purpose :). The injected js is loaded outside the actual user session (in most cases), and it does render inside some admin dashboard, or any other areas where the injected input wasn&rsquo;t sanitized before it&rsquo;s rendered! when I had received the callback from the <code>xss hunter</code> report, I immediatly (to be honest, it was late and decided to check it the other day) requested the same url <code>domain/admin</code>, and tried to impersonate the admin session, and horray I&rsquo;m in !</p>
<h3 id="starting-from-the-end">Starting from the end:</h3>
<p>This is the flashback of the results caused by the underlining issue:</p>
<ul>
<li>
<p>My PoC using the dashboard in question:
<figure>
    <img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo3=.png" width="600px" height="100px"/> 
        <figcaption style="margin-top:10px;font-family: sohne, 'Helvetica Neue', Helvetica, Arial, sans-serif;color: rgba(117, 117, 117, 1);">
        Reported PoC
        </figcaption></figure></p>
</li>
<li>
<p>Bitdefender Administrator&rsquo;s Dashboard:
<figure>
    <img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo1=.png" width="800px" height="530px"/> 
        <figcaption style="margin-top:10px;font-family: sohne, 'Helvetica Neue', Helvetica, Arial, sans-serif;color: rgba(117, 117, 117, 1);">
        Bitdefender Dashboard1
        </figcaption></figure></p>
</li>
<li>
<p>Bitdefender sells :), some money !
<figure>
    <img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo2=.png" width="800px" height="530px"/> 
        <figcaption style="margin-top:10px;font-family: sohne, 'Helvetica Neue', Helvetica, Arial, sans-serif;color: rgba(117, 117, 117, 1);">
        Bitdefender Dashboard2
        </figcaption></figure></p>
</li>
<li>
<p>Bitdefender Admin Cookies :
<figure>
    <img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo4=.png" width="600px" height="100px"/> 
        <figcaption style="margin-top:10px;font-family: sohne, 'Helvetica Neue', Helvetica, Arial, sans-serif;color: rgba(117, 117, 117, 1);">
        Bitdefender adminâ€™s session
        </figcaption></figure></p>
</li>
<li>
<p>Xss hunter report:
<figure>
    <img class="featured_img" src="/images/Ynhzcy1iaXRkZWZlbmRlcgo5=.png" width="600px" height="300px"/> 
        <figcaption style="margin-top:10px;font-family: sohne, 'Helvetica Neue', Helvetica, Arial, sans-serif;color: rgba(117, 117, 117, 1);">
        Xss hunter report
        </figcaption></figure></p>
</li>
</ul>
<h3 id="sessions-are-meant-to-be-distroyed">Sessions are meant to be distroyed:</h3>
<p>The &ldquo;main&rdquo; raison that let me use the admin&rsquo;s session cookies, is simply they weren&rsquo;t revoked at all(it&rsquo;s an issue in itself) and thus allow anyone with the right cookies to get in. Besides, no <code>httpOnly</code> flag was set on cookies that could restrict them from being stolen. As a takeaway, and for safety raison any time you used a &ldquo;web&rdquo; application and you are done with it, just simply <code>log out</code>, and don&rsquo;t keep your sessions valid, as some of the apps doesn&rsquo;t revoke them automatically!</p>
<h3 id="final-note-to-self--">Final note: (to self)  ðŸ˜¬</h3>
<ul>
<li>
<p>Sometimes even if the input seems to be sanitized, and the payload rendered html encoded for instance, just make sure to test it again and mark that input and wait !</p>
</li>
<li>
<p>Never underestimate a client side bug ! and just test for them. (don&rsquo;t be that lazy).</p>
</li>
</ul>
<h2 id="nb">NB:</h2>
<p>Nothing was retrieved from the server. The issue was fixed by the bitdefender team.</p>
<h5 id="refs">Refs:</h5>
<p><a href="https://developer.mozilla.org/fr/docs/Web/HTTP/Cookies">Http-Cookies</a></p>

	
<a class="tag" href="/tags/bxss">#bxss</a>
	
<a class="tag" href="/tags/session-hijacking">#session-hijacking</a>

</main>
<aside>
<div class="latest-posts">
    <h3 style="text-align: center;">
        Category: 
        
        <a class="cat" href="/categories/bugs">
            bugs
        </a>
        
    </h3>
    <ul>
        
            
            
       <table>
            
            
             
        <tr>
            <th><li style="list-style: none;"><span>Next</span>: </th><td><a href="https://s1m0x.xyz/post/bugs/lfi-is-calling/">From academic research to LFD critical vulnerability</a></li></td>
            
        </tr>
            
            
            
        <tr>
            <th><li style="list-style: none;"><span>Previous</span>: </th><td><a href="https://s1m0x.xyz/post/bugs/juicy-js-rce/">Juicy Infos hidden in js scripts leads to RCE</a></li></td>
            
        </tr>
            
            
            
        </table>

    </ul>
</div>
</aside>
  <footer>
  
  
  </footer>
  <script>
    
    window.onscroll = function() {myFunction()};

    function myFunction() {
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;
      document.getElementById("myBar").style.width = scrolled + "%";
    }
</script>
  </body>
</html>

